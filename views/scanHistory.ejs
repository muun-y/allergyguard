<%- include("templates/header") %>
    <%- include("templates/navbar") %>

        <div class="p-6 max-w-4xl mx-auto space-y-6">
            <header>
                <h2 class="text-2xl font-semibold">Scan History</h2>
                <p class="text-sm text-gray-600">All your scanned labels</p>
            </header>

            <% if (!history || history.length===0) { %>
                <p class="text-sm text-gray-500">No history yet.</p>
                <% } else { %>
                    <div class="overflow-x-auto border rounded">
                        <table class="w-full text-sm text-left text-gray-700">
                            <thead class="bg-gray-100 border-b">
                                <tr>
                                    <th class="px-4 py-2">Date</th>
                                    <th class="px-4 py-2">Matched Allergens</th>
                                    <th class="px-4 py-2">Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <% history.forEach(function(h){ %>
                                    <tr class="border-b hover:bg-gray-50">
                                        <td class="px-4 py-2">
                                            <%= new Date(h.createdAt.toDate()).toLocaleString() %>
                                        </td>
                                        <td class="px-4 py-2">
                                            <% if (h.matched && h.matched.length> 0) { %>
                                                <span class="text-red-600 font-semibold">
                                                    <%= h.matched.join(", ") %></span>
                <% } else { %>
                  <span class=" text-green-600 font-semibold">None
                                                </span>
                                                <% } %>
                                        </td>
                                        <td class="px-4 py-2">
                                            <a href="/scan-history/<%= h.id %>"
                                                class="text-blue-600 hover:underline text-sm">Details</a>
                                        </td>
                                    </tr>
                                    <% }) %>
                            </tbody>
                        </table>
                    </div>
                    <% } %>
        </div>

        <%- include("templates/footer") %>